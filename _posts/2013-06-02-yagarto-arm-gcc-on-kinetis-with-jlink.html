---
layout: post
title: "GCC ARM Embedded + Eclipse on Kinetis with JLink"
date: 2013-06-02
comments: true
categories:
 - embedded
 - tutorial
---

<div class='post'>
I have been writing my own start-up and a linker command file for K60 Tower board. Unfortunately, I am still having an unidentified problem with OSJTAG, I&nbsp; had decided to use jlink with eclipse. I don't use yagarto tool chain, decided to go with GCC ARM embedded.<br />&nbsp;There's been many resources on the internet, I'll post which helped me to set it correctly.<br /><br /><a href="http://thehackerworkshop.com/?p=391">Getting Started with the ARM GCC Compiler on Windows PART 1 [thehackerworkshop.com]</a><br />Guide how to set eclipse development (GCC ARM, make, eclipse). This guide (Part 1 plus part 2) is more detailed than the original one published on emb4fun.<br /><br />You can skip few steps in PART 2, right to the Step 5 if you are not using the ST discovery board. This is the most important one, once you set everything, add files, you should be able to compile and link your project files.<br /><br />This is a highlight what you should look for:<br /><ul><li>C/C++ Build - External builder , build command - make (or set PATH correctly)</li><li>C/C++ Build - Discovery options - set arm-none-eabi-</li><li>In linker options inside Tool Settings - there's a flag where you type a path to a linker command file (an example : -T ./../Sources/PK60N512_flash.ld)</li><li>In compiler options inside Tool Settings - there's other flags option where you type at least these two flags -mcpu=cortex-m4 -mthumb (same should apply for assembler flags)</li></ul><br />The last step before debugging, is to set gdb commands inside a created debug configuration (click 2x on the GDB hardware debugging to create a new one). This are taken from the example shared on yagarto webpage, targeted for K40. They are valid for jlink.<br /><br />These are initialization commands:<br /><pre class="brush: python">target remote localhost:2331<br />monitor flash device = MK60DN512xxx10<br />monitor flash download = 1<br />monitor flash breakpoints = 1<br />monitor clrbp<br />monitor endian little<br />monitor speed 1000<br />monitor reset<br />monitor sleep 100<br />monitor speed auto<br />monitor writeu32 0xE000ED08 = 0x00000000<br /></pre><br />These are run commands:<br /><pre class="brush: python">monitor reg r13 = (0x00000000)<br />monitor reg pc = (0x00000004)<br />break main<br />continue<br /></pre><br />I did not want to repeat what you can find online, but if there's anything unclear, not able to debug your application using jlink on any Tower from Kinetis line, let me know and I can expand this into a small tutorial ;)<br /><br />I am planning to publish a small gcc application for some tower boards, or perhaps all, depends on how much time I'll have these days ;) Because when you look into code what CodeWarrior generates with gcc, you marvel how much lines that code contains, most of it are unnecessary.<br /><br />Update June 9th: a demo app for TWRK60N512 is published.</div>
