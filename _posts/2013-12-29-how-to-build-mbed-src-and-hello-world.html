---
layout: post
title: "How to build mbed src and Hello world (AMRCC, ARM GCC) (tutorial)"
date: 2013-12-29
comments: true
categories:
 - tutorial
 - mbed
---

<div class='post'>
This tutorial is dedicated to building mbed sources and exporting hello world. K20D5M is going to be used as an example, because it is still not available in the mbed online compiler. Thus this give us to compile any application based on mbed libraries. My machine is running Windows so paths presented in the 2nd step are for windows.<br /><br /><b>1. Download the mbed github repository</b><br /><br />If you are familiar with git, just clone repository using git clone command. For those who don't use git, download the repository as archive (zip). <br />Link <a href="https://github.com/mbedmicro/mbed/archive/master.zip">mbed src ZIP archive (~5MB) [github.com/mbedmicro/mbed]</a><br /><br />After downloading is completed, unzip the archive.<br /><br /><b>2. Set your toolchain paths</b><br /><br />There few toolchains which can be used, I'll present ARM GCC and ARMCC (uVision). Create a new file named private_settings.py in the workspace_tools directory. This private settings file defines settings which overrides default settings.<br /><br /><pre class="brush: cpp">from os.path import join<br />#KEIL<br />ARM_PATH = "C:/Keil/ARM"<br />ARM_BIN = join(ARM_PATH,"ARMCC","bin")<br />ARM_INC = join(ARM_PATH,"RV31","INC")<br />ARM_LIB    = join(ARM_PATH,"ARMCC","lib")<br />ARM_CPPLIB = join(ARM_PATH, "ARMCC","lib","cpplib")<br /><br />#GCC ARM<br />GCC_ARM_PATH = "C:/Program Files/GNU Tools ARM Embedded/4.7 2013q3/bin"<br /><br />BUILD_OPTIONS = ["debug-info"]<br /></pre><br />ARM_ paths are used for ARMCC (uVision IDE, paths for each folders might vary, as I had problems with previous versions, because they changed the folder structure), GCC_ARM_ path for ARM GCC toolchain path. Set those according your installation folder. <br />I use debug-info build-option, to include debug symbols.<br /><br /><b>3. Build sources for your target</b><br /><br />To build mbed sources for TARGET and TOOLCHAIN, use command:<br /><pre class="brush: cpp">python build.py -m TARGET -t TOOLCHAIN<br /></pre><br />The list of supported targets is quite long, to check if your TARGET is supported <a href="https://github.com/mbedmicro/mbed/blob/master/workspace_tools/targets.py#L342">TARGETS array [github.com/mbedmicro/mbed]</a>.<br />Each TARGET defines supported TOOLCHAIN. For example, K20D5M has ARM and GCC_ARM.<br /><br />To build for ARM (that's ARMCC used in uVision for example)<br /><pre class="brush: cpp">python build.py -m K20D5M -t ARM<br /></pre><br />To build for GCC ARM<br /><pre class="brush: cpp">python build.py -m K20D5M -t GCC_ARM<br /></pre><br />If you just invoke command without -t, the target will be built for all supported toolchains.<br /><br /><b>4. Using exporters</b><br /><br />As soon as you have built mbed sources for your target, go to my previous tutorial about using exporters. There is just shown to export Hello world example. <br /><br /><a href="http://embeddedworldweb.blogspot.sk/2013/12/how-to-use-mbed-exporters-tutorial.html">How to use mbed exporters</a><br /><br /><b>5. Build an application</b><br /><br />Using ARM GCC, use makefile to build an application. If uVision is used, build the application in the uVision IDE. No matter what toolchain you use, they should generate a binary file, which can be copied to mbed msd drive. Same procedure as it's used by the mbed online compiler.</div>
